<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Мониторинг светофоров Актобе</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background-color: #2c3e50;
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .map-container {
            position: relative;
            flex: 1;
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            min-height: 400px;
        }
        
        #map {
            height: 100%;
            width: 100%;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-success {
            background-color: #2ecc71;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .traffic-light {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin: 2px;
            display: inline-block;
        }
        
        .traffic-light.red {
            background-color: #e74c3c;
        }
        
        .traffic-light.yellow {
            background-color: #f39c12;
        }
        
        .traffic-light.green {
            background-color: #2ecc71;
        }
        
        .traffic-lights-list {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .traffic-lights-list h2 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .traffic-light-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .traffic-light-item:last-child {
            border-bottom: none;
        }
        
        .light-status {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .timer {
            font-weight: bold;
            font-size: 1.2rem;
            color: #2c3e50;
        }
        
        .add-traffic-light-form {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .add-traffic-light-form h2 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        /* Стили для маркера местоположения */
        .location-marker {
            background-color: #3498db;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            border: 3px solid white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }
        
        /* Стили для уведомлений */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }
        
        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }
        
        .notification.success {
            background-color: #2ecc71;
        }
        
        .notification.error {
            background-color: #e74c3c;
        }
        
        .cloud-status {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            font-size: 0.9rem;
        }
        
        .cloud-icon {
            width: 20px;
            height: 20px;
        }
        
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .db-status {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 5px;
            font-size: 0.9rem;
        }
        
        .db-icon {
            width: 20px;
            height: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Мониторинг светофоров Актобе</h1>
            <p>Отслеживайте статус и работу светофоров на карте города</p>
            <div class="cloud-status" id="cloudStatus">
                <svg class="cloud-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M6 19C3.79 19 2 17.21 2 15C2 13.07 3.36 11.44 5.22 11.08C5.76 7.05 9.13 4 13.5 4C17.64 4 20.9 6.7 21.5 10.5C23.34 10.97 25 12.56 25 14.5C25 16.71 23.21 18.5 21 18.5H6Z" fill="#3498db"/>
                </svg>
                <span>Данные синхронизированы с облаком</span>
            </div>
            <div class="db-status" id="dbStatus">
                <svg class="db-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 4C7.58 4 4 5.79 4 8C4 10.21 7.58 12 12 12C16.42 12 20 10.21 20 8C20 5.79 16.42 4 12 4ZM4 10V14C4 16.21 7.58 18 12 18C16.42 18 20 16.21 20 14V10C20 12.21 16.42 14 12 14C7.58 14 4 12.21 4 10ZM4 16V20C4 22.21 7.58 24 12 24C16.42 24 20 22.21 20 20V16C20 18.21 16.42 20 12 20C7.58 20 4 18.21 4 16Z" fill="#2ecc71"/>
                </svg>
                <span>Все данные сохраняются в базу данных</span>
            </div>
        </header>
        
        <div class="map-container">
            <div id="map"></div>
        </div>
        
        <div class="controls">
            <button class="btn btn-primary" id="myLocation">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 8C9.79 8 8 9.79 8 12C8 14.21 9.79 16 12 16C14.21 16 16 14.21 16 12C16 9.79 14.21 8 12 8ZM20.94 11C20.48 6.83 17.17 3.52 13 3.06V1H11V3.06C6.83 3.52 3.52 6.83 3.06 11H1V13H3.06C3.52 17.17 6.83 20.48 11 20.94V23H13V20.94C17.17 20.48 20.48 17.17 20.94 13H23V11H20.94ZM12 19C8.13 19 5 15.87 5 12C5 8.13 8.13 5 12 5C15.87 5 19 8.13 19 12C19 15.87 15.87 19 12 19Z" fill="white"/>
                </svg>
                Мое местоположение
            </button>
            <button class="btn btn-success" id="simulateTraffic">
                Запустить симуляцию светофоров
            </button>
            <button class="btn btn-danger" id="clearAll">
                Очистить все
            </button>
        </div>
        
        <div class="traffic-lights-list">
            <h2>Список светофоров</h2>
            <div id="trafficLightsContainer">
                <!-- Светофоры будут добавлены здесь -->
            </div>
        </div>
        
        <div class="add-traffic-light-form">
            <h2>Добавить новый светофор</h2>
            <div class="form-group">
                <label for="lightName">Название перекрестка</label>
                <input type="text" id="lightName" placeholder="пр. Абулхаир хана / ул. Айтеке би">
            </div>
            <div class="form-group">
                <label for="lightLat">Широта</label>
                <input type="number" id="lightLat" step="0.0001" placeholder="50.2876">
            </div>
            <div class="form-group">
                <label for="lightLng">Долгота</label>
                <input type="number" id="lightLng" step="0.0001" placeholder="57.1687">
            </div>
            <div class="form-actions">
                <button class="btn btn-primary" id="addTrafficLight">Добавить светофор</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script>
        // Инициализация карты
        const map = L.map('map').setView([50.2836, 57.1667], 13);
        
        // Добавление слоя OpenStreetMap
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        }).addTo(map);
        
        // Имитация базы данных
        const database = {
            // В реальном приложении здесь будут вызовы к API базы данных
            async saveData(data) {
                // Имитация задержки сети
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Сохраняем в localStorage для демонстрации
                // В реальном приложении здесь будет вызов к API базы данных
                localStorage.setItem('trafficLightsDB', JSON.stringify(data));
                
                return true;
            },
            
            async loadData() {
                // Имитация задержки сети
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // Загружаем из localStorage для демонстрации
                // В реальном приложении здесь будет вызов к API базы данных
                const data = localStorage.getItem('trafficLightsDB');
                return data ? JSON.parse(data) : [];
            },
            
            async addRecord(record) {
                const data = await this.loadData();
                record.id = data.length > 0 ? Math.max(...data.map(item => item.id)) + 1 : 1;
                data.push(record);
                return await this.saveData(data);
            },
            
            async updateRecord(id, updates) {
                const data = await this.loadData();
                const index = data.findIndex(item => item.id === id);
                
                if (index !== -1) {
                    data[index] = { ...data[index], ...updates };
                    return await this.saveData(data);
                }
                
                return false;
            },
            
            async deleteRecord(id) {
                const data = await this.loadData();
                const filteredData = data.filter(item => item.id !== id);
                return await this.saveData(filteredData);
            },
            
            async clearAll() {
                return await this.saveData([]);
            }
        };
        
        // Функция для работы с базой данных
        async function saveToDatabase(lights) {
            const dbStatus = document.getElementById('dbStatus');
            dbStatus.innerHTML = '<div class="loading"></div> <span>Сохранение в базу данных...</span>';
            
            try {
                const success = await database.saveData(lights);
                
                if (success) {
                    dbStatus.innerHTML = `
                        <svg class="db-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4C7.58 4 4 5.79 4 8C4 10.21 7.58 12 12 12C16.42 12 20 10.21 20 8C20 5.79 16.42 4 12 4ZM4 10V14C4 16.21 7.58 18 12 18C16.42 18 20 16.21 20 14V10C20 12.21 16.42 14 12 14C7.58 14 4 12.21 4 10ZM4 16V20C4 22.21 7.58 24 12 24C16.42 24 20 22.21 20 20V16C20 18.21 16.42 20 12 20C7.58 20 4 18.21 4 16Z" fill="#2ecc71"/>
                        </svg>
                        <span>Все данные сохраняются в базу данных</span>
                    `;
                    return true;
                }
            } catch (error) {
                console.error('Ошибка сохранения в базу данных:', error);
            }
            
            dbStatus.innerHTML = `
                <svg class="db-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 4C7.58 4 4 5.79 4 8C4 10.21 7.58 12 12 12C16.42 12 20 10.21 20 8C20 5.79 16.42 4 12 4ZM4 10V14C4 16.21 7.58 18 12 18C16.42 18 20 16.21 20 14V10C20 12.21 16.42 14 12 14C7.58 14 4 12.21 4 10ZM4 16V20C4 22.21 7.58 24 12 24C16.42 24 20 22.21 20 20V16C20 18.21 16.42 20 12 20C7.58 20 4 18.21 4 16Z" fill="#e74c3c"/>
                </svg>
                <span>Ошибка сохранения в базу данных</span>
            `;
            
            return false;
        }
        
        async function loadFromDatabase() {
            const dbStatus = document.getElementById('dbStatus');
            dbStatus.innerHTML = '<div class="loading"></div> <span>Загрузка данных из базы...</span>';
            
            try {
                const data = await database.loadData();
                
                dbStatus.innerHTML = `
                    <svg class="db-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 4C7.58 4 4 5.79 4 8C4 10.21 7.58 12 12 12C16.42 12 20 10.21 20 8C20 5.79 16.42 4 12 4ZM4 10V14C4 16.21 7.58 18 12 18C16.42 18 20 16.21 20 14V10C20 12.21 16.42 14 12 14C7.58 14 4 12.21 4 10ZM4 16V20C4 22.21 7.58 24 12 24C16.42 24 20 22.21 20 20V16C20 18.21 16.42 20 12 20C7.58 20 4 18.21 4 16Z" fill="#2ecc71"/>
                    </svg>
                    <span>Все данные сохраняются в базу данных</span>
                `;
                
                return data;
            } catch (error) {
                console.error('Ошибка загрузки из базы данных:', error);
                
                dbStatus.innerHTML = `
                    <svg class="db-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 4C7.58 4 4 5.79 4 8C4 10.21 7.58 12 12 12C16.42 12 20 10.21 20 8C20 5.79 16.42 4 12 4ZM4 10V14C4 16.21 7.58 18 12 18C16.42 18 20 16.21 20 14V10C20 12.21 16.42 14 12 14C7.58 14 4 12.21 4 10ZM4 16V20C4 22.21 7.58 24 12 24C16.42 24 20 22.21 20 20V16C20 18.21 16.42 20 12 20C7.58 20 4 18.21 4 16Z" fill="#e74c3c"/>
                    </svg>
                    <span>Ошибка загрузки из базы данных</span>
                `;
                
                return [];
            }
        }
        
        // Загрузка светофоров из базы данных
        let trafficLights = [];
        
        // Маркеры для светофоров
        const markers = [];
        
        // Иконки для разных состояний светофора
        const redIcon = L.divIcon({
            html: '<div style="background-color: #e74c3c; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 0 3px #e74c3c"></div>',
            className: '',
            iconSize: [24, 24]
        });
        
        const yellowIcon = L.divIcon({
            html: '<div style="background-color: #f39c12; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 0 3px #f39c12"></div>',
            className: '',
            iconSize: [24, 24]
        });
        
        const greenIcon = L.divIcon({
            html: '<div style="background-color: #2ecc71; width: 20px; height: 20px; border-radius: 50%; border: 2px solid white; box-shadow: 0 0 0 3px #2ecc71"></div>',
            className: '',
            iconSize: [24, 24]
        });
        
        // Функция для получения иконки по состоянию
        function getIconByState(state) {
            switch(state) {
                case 'red': return redIcon;
                case 'yellow': return yellowIcon;
                case 'green': return greenIcon;
                default: return redIcon;
            }
        }
        
        // Функция для отображения уведомления
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // Добавление светофоров на карту
        function addTrafficLightsToMap() {
            // Очистка предыдущих маркеров
            markers.forEach(marker => {
                map.removeLayer(marker.marker);
            });
            markers.length = 0;
            
            // Добавление светофоров на карту
            trafficLights.forEach(light => {
                const marker = L.marker([light.lat, light.lng], { icon: getIconByState(light.state) })
                    .addTo(map)
                    .bindPopup(`<b>${light.name}</b><br>Состояние: ${getStateName(light.state)}<br>Таймер: ${light.timer} сек`);
                
                markers.push({
                    id: light.id,
                    marker: marker,
                    state: light.state,
                    timer: light.timer
                });
            });
        }
        
        // Функция для получения русского названия состояния
        function getStateName(state) {
            switch(state) {
                case 'red': return 'Красный';
                case 'yellow': return 'Желтый';
                case 'green': return 'Зеленый';
                default: return 'Неизвестно';
            }
        }
        
        // Функция для отображения списка светофоров
        function renderTrafficLightsList() {
            const container = document.getElementById('trafficLightsContainer');
            container.innerHTML = '';
            
            if (trafficLights.length === 0) {
                container.innerHTML = '<div class="traffic-light-item"><div>Нет добавленных светофоров</div></div>';
                return;
            }
            
            trafficLights.forEach(light => {
                const item = document.createElement('div');
                item.className = 'traffic-light-item';
                
                item.innerHTML = `
                    <div>
                        <strong>${light.name}</strong>
                        <div>Координаты: ${light.lat.toFixed(4)}, ${light.lng.toFixed(4)}</div>
                    </div>
                    <div class="light-status">
                        <span class="traffic-light ${light.state}"></span>
                        <span>${getStateName(light.state)}</span>
                        <span class="timer">${light.timer} сек</span>
                        <button class="btn btn-danger" data-id="${light.id}">Удалить</button>
                    </div>
                `;
                
                container.appendChild(item);
            });
            
            // Добавляем обработчики для кнопок удаления
            document.querySelectorAll('.btn-danger[data-id]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    deleteTrafficLight(id);
                });
            });
        }
        
        // Функция для удаления светофора
        async function deleteTrafficLight(id) {
            const success = await database.deleteRecord(id);
            
            if (success) {
                trafficLights = trafficLights.filter(light => light.id !== id);
                await saveToDatabase(trafficLights);
                addTrafficLightsToMap();
                renderTrafficLightsList();
                showNotification('Светофор удален из базы данных', 'success');
            } else {
                showNotification('Ошибка при удалении светофора из базы данных', 'error');
            }
        }
        
        // Функция для добавления нового светофора
        async function addNewTrafficLight() {
            const name = document.getElementById('lightName').value.trim();
            const lat = parseFloat(document.getElementById('lightLat').value);
            const lng = parseFloat(document.getElementById('lightLng').value);
            
            if (!name || isNaN(lat) || isNaN(lng)) {
                showNotification('Заполните все поля корректно', 'error');
                return;
            }
            
            // Добавляем новый светофор
            const newLight = {
                lat: lat,
                lng: lng,
                name: name,
                state: 'red',
                timer: 20
            };
            
            const success = await database.addRecord(newLight);
            
            if (success) {
                // Обновляем данные из базы
                trafficLights = await loadFromDatabase();
                addTrafficLightsToMap();
                renderTrafficLightsList();
                
                // Очищаем форму
                document.getElementById('lightName').value = '';
                document.getElementById('lightLat').value = '';
                document.getElementById('lightLng').value = '';
                
                showNotification('Светофор добавлен в базу данных', 'success');
            } else {
                showNotification('Ошибка при добавлении светофора в базу данных', 'error');
            }
        }
        
        // Функция для обновления состояния светофора
        async function updateTrafficLightState(id, state, timer) {
            // Обновляем данные
            const lightIndex = trafficLights.findIndex(light => light.id === id);
            if (lightIndex !== -1) {
                trafficLights[lightIndex].state = state;
                trafficLights[lightIndex].timer = timer;
                
                // Сохраняем изменения в базе данных
                await database.updateRecord(id, {
                    state: state,
                    timer: timer
                });
            }
            
            // Обновляем маркер на карте
            const markerIndex = markers.findIndex(m => m.id === id);
            if (markerIndex !== -1) {
                markers[markerIndex].marker.setIcon(getIconByState(state));
                markers[markerIndex].state = state;
                markers[markerIndex].timer = timer;
                
                // Обновляем popup
                const light = trafficLights[lightIndex];
                markers[markerIndex].marker.setPopupContent(
                    `<b>${light.name}</b><br>Состояние: ${getStateName(state)}<br>Таймер: ${timer} сек`
                );
            }
            
            // Обновляем список
            renderTrafficLightsList();
        }
        
        // Инициализация при загрузке страницы
        async function initApp() {
            // Загружаем данные из базы данных
            trafficLights = await loadFromDatabase();
            
            // Добавляем светофоры на карту и в список
            addTrafficLightsToMap();
            renderTrafficLightsList();
        }
        
        // Запускаем инициализацию
        initApp();
        
        // Переменная для хранения маркера местоположения
        let locationMarker = null;
        
        // Функция для определения местоположения пользователя
        document.getElementById('myLocation').addEventListener('click', function() {
            if ("geolocation" in navigator) {
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        // Удаляем предыдущий маркер, если он есть
                        if (locationMarker) {
                            map.removeLayer(locationMarker);
                        }
                        
                        // Создаем новый маркер с пользовательским стилем
                        locationMarker = L.marker([lat, lng], {
                            icon: L.divIcon({
                                className: 'location-marker',
                                iconSize: [24, 24]
                            })
                        }).addTo(map);
                        
                        // Центрируем карту на местоположении пользователя
                        map.setView([lat, lng], 16);
                        
                        // Добавляем popup к маркеру
                        locationMarker.bindPopup('Ваше местоположение').openPopup();
                    },
                    function(error) {
                        showNotification('Не удалось определить ваше местоположение. Проверьте настройки геолокации.', 'error');
                    }
                );
            } else {
                showNotification('Геолокация не поддерживается вашим браузером.', 'error');
            }
        });
        
        // Симуляция работы светофоров
        document.getElementById('simulateTraffic').addEventListener('click', function() {
            // Запускаем интервал для симуляции
            setInterval(function() {
                trafficLights.forEach(light => {
                    let newState = light.state;
                    let newTimer = light.timer - 1;
                    
                    if (newTimer <= 0) {
                        // Меняем состояние светофора
                        if (light.state === 'red') {
                            newState = 'green';
                            newTimer = 20;
                        } else if (light.state === 'green') {
                            newState = 'yellow';
                            newTimer = 5;
                        } else if (light.state === 'yellow') {
                            newState = 'red';
                            newTimer = 20;
                        }
                    }
                    
                    // Обновляем состояние светофора
                    updateTrafficLightState(light.id, newState, newTimer);
                });
            }, 1000);
            
            // Делаем кнопку неактивной после нажатия
            this.disabled = true;
            this.textContent = 'Симуляция запущена';
            
            showNotification('Симуляция светофоров запущена', 'success');
        });
        
        // Очистка всех светофоров
        document.getElementById('clearAll').addEventListener('click', async function() {
            if (confirm('Вы уверены, что хотите удалить все светофоры из базы данных?')) {
                const success = await database.clearAll();
                
                if (success) {
                    trafficLights = [];
                    addTrafficLightsToMap();
                    renderTrafficLightsList();
                    showNotification('Все светофоры удалены из базы данных', 'success');
                } else {
                    showNotification('Ошибка при удалении светофоров из базы данных', 'error');
                }
            }
        });
        
        // Добавление нового светофора
        document.getElementById('addTrafficLight').addEventListener('click', addNewTrafficLight);
    </script>
</body>
</html>
